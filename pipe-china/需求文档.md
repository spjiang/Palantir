# 管网单点运维业务需求文档（石油/天然气输送）

## 1. 背景与目标
管网集团承担石油与天然气的长距离输送任务，运行安全依赖于对管道状态的持续监测与及时处置。当前业务系统能够记录传感器数据、报警与工单结果，但对于“为什么会发生、通过什么判断与处置行为导致状态变化”缺少统一、可复用、可追溯的业务表达。

本需求选择 **一个且仅一个** 运维点，作为后续推广的样板：

**运维点：管道泄漏风险识别与处置（Leak Risk Handling）**

业务目标：
- 把“泄漏从怀疑到确认、从处置到闭环”的全过程表达清楚
- 把经验判断沉淀为可复用的规则与约束，减少对个人经验的依赖
- 把一次处置过程中的关键对象、状态变化、动作与证据完整留痕，便于复盘与审计

## 2. 范围界定（只聚焦一个运维点）
本需求只覆盖以下范围：
- 单一管段（一个处置单元，必要时可包含其紧邻的上游/下游站场连接信息，用于隔离影响分析）
- 泄漏风险的识别、评估、决策、执行与回写
- 与泄漏相关的传感器数据、告警、任务/工单、审批与证据

不覆盖：
- 其它运维点（腐蚀、第三方破坏、站场设备故障、调峰优化等）
- 全网级多场景联动预案与跨区域协同

## 3. 业务角色与职责
- 调度值班员：接收风险提示、组织研判、下达处置指令、监督闭环
- 站控/监控员：关注实时压力/流量/告警，提供监测侧解释与确认建议
- 运维班组（现场）：执行巡检/隔离/降压/停输等动作并回传证据
- 审批人（值班领导/安全负责人）：对高风险动作进行审批放行并明确风险承担
- 安全管理/审计：抽查过程合规性、证据完整性与责任边界

## 4. 关键业务对象（对象/状态/证据）
### 4.1 关键对象清单
- 管段（PipelineSegment）：管段编号、介质类型（油/气）、设计压力、当前压力、地理位置、所属站场/责任单位
- 站场（Station）：站场编号、名称、位置、值守状态、联系方式
- 传感器（Sensor）：编号、类型（压力/流量/温度/声学/振动）、安装位置、当前值、采集时间、数据质量状态
- 告警（Alarm）：告警类型、级别、触发条件摘要、触发时间、关联对象、是否已确认、关闭原因
- 风险状态（RiskState）：Normal（正常）/ SuspectedLeak（疑似泄漏）/ ConfirmedLeak（确认泄漏）/ Emergency（紧急）
- 异常识别记录（AnomalyDetection）：触发原因摘要、触发时间、关键指标与阈值、关联告警/对象
- 风险评估（RiskAssessment）：评估结论（高/中/低）、评估依据摘要、评估时间、评估人/来源
- 处置决策（ResponseDecision）：选择的处置策略、被否决/禁用策略及原因、审批结论、决策时间
- 运维任务/工单（MaintenanceTask）：任务类型、目标对象、责任班组、SLA、状态、到场/完成时间
- 现场处置记录（OnsiteActionRecord）：动作清单、执行人、执行时间、结果描述
- 证据（Evidence）：定位轨迹、照片/视频、现场读数、阀门操作记录、停输/降压确认单等
- 事件（Incident）：围绕一次泄漏风险处置形成的事件主线，关联告警、评估、决策、任务、证据与结论

### 4.2 关键状态属性（示例）
- PipelineSegment.current_pressure（当前压力）
- PipelineSegment.flow_rate（流量，可来自计量点）
- PipelineSegment.medium_type（油/气）
- PipelineSegment.risk_state（当前风险状态）
- Sensor.data_quality（正常/缺失/漂移/故障）
- Alarm.ack_status（未确认/已确认/已关闭）
- MaintenanceTask.status（待执行/执行中/已完成/已取消/超时）
- Evidence.completeness（证据是否齐全）

## 5. 对象之间的业务关系（示例）
以下关系用于表达“结构世界”（谁属于谁、谁影响谁、谁指向谁）：
- 管段 HAS_SENSOR 传感器
- 站场 OWNS 管段
- 站场 CONNECTED_TO 管段（上游/下游连接，用于隔离影响分析）
- 告警 RELATED_TO 管段/传感器
- 管段 HAS_RISK_STATE 风险状态
- 异常识别记录 DETECTED_FOR 管段
- 风险评估 ASSESSES 管段
- 处置决策 DECIDES_FOR 风险评估/管段
- 运维任务 TARGETS 管段
- 运维班组/人员 EXECUTES 运维任务
- 运维任务 PRODUCES 现场处置记录
- 现场处置记录 HAS_EVIDENCE 证据
- 事件 CONTAINS 告警/评估/决策/任务/证据/结论

## 6. 运维行为与规则（本需求的核心）
在泄漏风险处置中，业务关注的不是“数据本身”，而是“数据在什么条件下触发了什么行为，导致了什么状态变化与新数据产生”。

### 6.1 行为一：异常识别（DetectAnomaly）
触发条件（示例）：
- 压力下降速率超过阈值
- 压力与流量出现不匹配（供需失衡）
- 声学/振动传感器出现疑似泄漏特征

结果：
- 风险状态：Normal → SuspectedLeak
- 生成异常识别记录，并把触发依据（关键指标/阈值/曲线片段）作为证据挂接

### 6.2 行为二：泄漏风险评估（AssessLeakRisk）
输入因素（示例）：
- 介质类型（油/气）、设计压力与当前压力趋势
- 历史故障/检维修记录与相似事件
- 同一时段相邻计量点数据一致性
- 现场巡检反馈（气味、噪声、地表异常等）

评估结论：
- 维持 SuspectedLeak 并给出风险等级（高/中/低）
- 或回退为 Normal（误报/瞬态波动）
- 或升级为 ConfirmedLeak（证据充分）

### 6.3 行为三：处置决策（DecideResponseAction）
可选处置策略（示例）：
- 现场巡检核查（DispatchInspection）
- 降压运行（ReducePressure）
- 分段隔离（IsolateSegment）
- 停输处置（ShutdownSegment）
- 持续监控（ContinueMonitoring）

约束规则（示例）：
- 当风险等级为“高”或风险状态为 ConfirmedLeak 时，禁止仅选择“持续监控”
- 涉及停输/分段隔离的动作必须经过审批，审批意见必须可追溯
- 夜间/恶劣天气下现场作业必须满足安全条件与人员配置（不满足则只能选择“可执行的安全策略集合”）

### 6.4 行为四：处置执行与回写（ExecuteMaintenance & WriteBack）
执行要求：
- 必须创建运维任务并明确责任班组与 SLA
- 关键动作必须形成现场处置记录，并附带证据（定位/照片/现场读数/操作记录）

回写结果：
- 更新风险状态（ConfirmedLeak → Emergency 或 ConfirmedLeak → Normal 等）
- 更新告警状态（确认/关闭，并记录关闭原因）
- 形成事件结论与责任边界说明（因何决策、谁审批、谁执行、证据是否齐全）

## 7. 处置闭环叙事（一次完整业务链）
1) 监控员发现某管段压力快速下降，同时流量出现异常波动，触发“异常识别”  
2) 调度值班员将该管段标记为“疑似泄漏”，要求形成风险评估依据，并下发“现场巡检核查”任务  
3) 现场班组到场核查，回传定位、照片/视频与现场读数；如发现明显泄漏迹象，提交“确认泄漏”的证据  
4) 调度值班员依据评估结论选择处置策略；当风险高时必须选择隔离/停输类策略，并发起审批  
5) 审批通过后，现场班组执行阀门操作、隔离或停输，回传操作记录与执行结果  
6) 系统回写：更新风险状态、更新事件状态、沉淀评估依据与决策原因，形成可追溯时间线  
7) 事件结束后形成复盘材料：关键节点、关键规则命中、关键证据、SLA 统计与改进建议

## 8. 业务输出与可追溯要求
- 每个事件必须能回答：
  - 为什么从 Normal 变为 SuspectedLeak（触发依据是什么）
  - 为什么从 SuspectedLeak 变为 ConfirmedLeak/Emergency（证据是什么）
  - 为什么选择该处置策略（有哪些策略被禁止/否决，原因是什么）
  - 谁在什么时间执行了什么动作（对应证据是什么）
- 必须提供“按事件回放”的时间线视角：告警 → 异常识别 → 评估 → 决策 → 审批 → 任务 → 证据 → 状态变化 → 结论

